<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Mini-Game</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Main Menu -->
    <div id="main-menu" class="screen active">
        <div class="menu-container">
            <h1>Yo That's Heat</h1>
            <p class="subtitle">A Gartic Phone-style collaborative music creation game</p>
            <div class="menu-buttons">
                <button id="tutorial-btn" class="menu-button">Tutorial</button>
                <button id="create-lobby-btn" class="menu-button primary">Create Lobby</button>
                <button id="join-lobby-btn" class="menu-button">Join Lobby</button>
            </div>
        </div>
    </div>

    <!-- Create Lobby -->
    <div id="create-lobby" class="screen">
        <div class="lobby-container">
            <h2>Create Lobby</h2>
            <div class="form-group">
                <label for="host-name">Your Name:</label>
                <input type="text" id="host-name" placeholder="Enter your name" maxlength="20">
            </div>
            <div class="lobby-buttons">
                <button id="back-to-menu-btn" class="secondary-button">Back</button>
                <button id="create-lobby-confirm-btn" class="primary-button">Create Lobby</button>
            </div>
        </div>
    </div>

    <!-- Join Lobby -->
    <div id="join-lobby" class="screen">
        <div class="lobby-container">
            <h2>Join Lobby</h2>
            <div class="form-group">
                <label for="player-name">Your Name:</label>
                <input type="text" id="player-name" placeholder="Enter your name" maxlength="20">
            </div>
            <div class="form-group">
                <label for="lobby-code">Lobby Code:</label>
                <input type="text" id="lobby-code" placeholder="Enter lobby code" maxlength="6" style="text-transform: uppercase;">
            </div>
            <div class="lobby-buttons">
                <button id="back-to-menu-from-join-btn" class="secondary-button">Back</button>
                <button id="join-lobby-confirm-btn" class="primary-button">Join Lobby</button>
            </div>
        </div>
    </div>

    <!-- Lobby Waiting Room -->
    <div id="lobby-waiting" class="screen">
        <div class="lobby-container">
            <h2>Lobby: <span id="lobby-code-display"></span></h2>
            <div class="connection-status">
                <span id="connection-indicator" class="connected">●</span>
                <span>Connected to server</span>
            </div>

            <div class="players-list">
                <h3>Players (<span id="player-count">0</span>):</h3>
                <div id="players-container">
                    <!-- Players will be populated here -->
                </div>
            </div>

            <div class="lobby-info">
                <p>Share this code with friends: <strong id="shareable-code"></strong></p>
                <p>Minimum 2 players required to start</p>
            </div>

            <div class="lobby-buttons">
                <button id="leave-lobby-btn" class="secondary-button">Leave Lobby</button>
                <button id="ready-btn" class="primary-button">Ready</button>
            </div>

            <div id="game-starting" class="game-starting" style="display: none;">
                <h3>All players ready! Starting game...</h3>
                <div class="countdown-circle">
                    <span id="start-countdown">3</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Tutorial Overlay -->
    <div id="tutorial" class="screen overlay">
        <div class="tutorial-content">
            <h2>How to Play</h2>
            <div class="tutorial-steps">
                <div class="step">
                    <h3>1. Sound Selection (10 seconds)</h3>
                    <p>Pick exactly 3 sounds from 5 random options. Hover to preview, click to select.</p>
                </div>
                <div class="step">
                    <h3>2. Performance Phase (1.5 minutes)</h3>
                    <p>Press keys 1, 2, 3 to play your chosen sounds and record them on an 8-second loop.</p>
                </div>
                <div class="step">
                    <h3>3. Editing Phase (1 minute)</h3>
                    <p>Drag notes up/down to change their pitch. Create your perfect melody!</p>
                </div>
                <div class="step">
                    <h3>4. Final Playback</h3>
                    <p>Listen to your creation! Your song will loop continuously.</p>
                </div>
            </div>
            <div class="tutorial-buttons">
                <button id="skip-tutorial-btn" class="secondary-button">Skip</button>
                <button id="start-tutorial-btn" class="primary-button">Start</button>
            </div>
        </div>
    </div>

    <!-- Sound Selection -->
    <div id="selection" class="screen">
        <div class="selection-header">
            <h2>Choose 3 Sounds</h2>
            <div class="countdown" id="selection-countdown">10</div>
        </div>
        <div class="sound-grid" id="sound-grid">
            <!-- Sound icons will be populated here -->
        </div>
        <div class="selection-footer">
            <div class="selected-count">Selected: <span id="selected-count">0</span>/3</div>
            <button id="continue-btn" class="primary-button" disabled>Continue</button>
        </div>
    </div>

    <!-- Performance Phase -->
    <div id="performance" class="screen">
        <div class="phase-header">
            <h2>Performance Phase</h2>
            <div class="countdown" id="performance-countdown">1:30</div>
            <div class="phase-countdown" id="phase-countdown"></div>
        </div>

        <div class="chosen-sounds">
            <div class="sound-key">
                <span class="key">1</span>
                <img id="sound-1-icon" class="sound-icon" alt="Sound 1">
            </div>
            <div class="sound-key">
                <span class="key">2</span>
                <img id="sound-2-icon" class="sound-icon" alt="Sound 2">
            </div>
            <div class="sound-key">
                <span class="key">3</span>
                <img id="sound-3-icon" class="sound-icon" alt="Sound 3">
            </div>
        </div>

        <div class="timeline-container">
            <canvas id="timeline-canvas" width="800" height="200"></canvas>
        </div>

        <div class="transport-controls">
            <button id="play-pause-btn" class="control-button">⏸️</button>
            <button id="restart-btn" class="control-button">⏮️</button>
            <div class="progress-container">
                <input type="range" id="progress-bar" min="0" max="8" step="0.1" value="0">
                <span id="time-display">0.0 / 8.0</span>
            </div>
            <button id="performance-continue-btn" class="primary-button">Finish Early</button>
        </div>
    </div>

    <!-- Editing Phase -->
    <div id="editing" class="screen">
        <div class="phase-header">
            <h2>Editing Phase</h2>
            <div class="countdown" id="editing-countdown">60</div>
            <div class="phase-countdown" id="editing-phase-countdown"></div>
        </div>

        <div class="editing-container">
            <div class="editing-track">
                <h3>Sound 1</h3>
                <canvas id="editing-canvas-1" width="800" height="650"></canvas>
            </div>
            <div class="editing-track">
                <h3>Sound 2</h3>
                <canvas id="editing-canvas-2" width="800" height="650"></canvas>
            </div>
            <div class="editing-track">
                <h3>Sound 3</h3>
                <canvas id="editing-canvas-3" width="800" height="650"></canvas>
            </div>
        </div>

        <div class="transport-controls">
            <button id="edit-play-pause-btn" class="control-button">▶️</button>
            <button id="edit-restart-btn" class="control-button">⏮️</button>
            <div class="progress-container">
                <input type="range" id="edit-progress-bar" min="0" max="8" step="0.1" value="0">
                <span id="edit-time-display">0.0 / 8.0</span>
            </div>
            <button id="editing-continue-btn" class="primary-button">Done!</button>
        </div>
    </div>

    <!-- Waiting for Players -->
    <div id="waiting-for-players" class="screen">
        <div class="waiting-container">
            <h2>Waiting for Everyone to Finish...</h2>
            <div class="waiting-info">
                <p id="waiting-message">Please wait while other players complete their parts.</p>
                <div class="round-info">
                    <span>Round <span id="current-round">1</span> of <span id="total-rounds">3</span></span>
                </div>
            </div>

            <div class="players-progress">
                <h3>Player Progress:</h3>
                <div id="players-progress-container">
                    <!-- Player progress will be populated here -->
                </div>
            </div>

            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
        </div>
    </div>

    <!-- Song Preview -->
    <div id="song-preview" class="screen">
        <div class="preview-container">
            <h2>Listen to the Previous Part</h2>
            <div class="preview-info">
                <p>This is what <span id="previous-player-name">Player</span> created.</p>
                <p>Now add your continuation to this song!</p>
                <div class="round-info">
                    <span>Round <span id="preview-current-round">2</span> of <span id="preview-total-rounds">3</span></span>
                </div>
            </div>

            <div class="preview-timeline-container">
                <canvas id="preview-canvas" width="800" height="200"></canvas>
            </div>

            <div class="transport-controls">
                <button id="preview-play-pause-btn" class="control-button">▶️</button>
                <button id="preview-restart-btn" class="control-button">⏮️</button>
                <div class="progress-container">
                    <input type="range" id="preview-progress-bar" min="0" max="8" step="0.1" value="0">
                    <span id="preview-time-display">0.0 / 8.0</span>
                </div>
            </div>

            <div class="preview-buttons">
                <button id="continue-to-performance-btn" class="primary-button">Continue to Add Your Part</button>
            </div>
        </div>
    </div>

    <!-- Final Showcase -->
    <div id="final-showcase" class="screen">
        <div class="showcase-container">
            <h2>Final Results</h2>
            <div class="showcase-info">
                <p>Here are all the completed collaborative songs!</p>
                <div class="song-navigation">
                    <span>Song <span id="current-song-number">1</span> of <span id="total-songs">3</span></span>
                    <div class="song-info">
                        <p>Created by: <span id="song-creators">Player1, Player2, Player3</span></p>
                    </div>
                </div>
            </div>

            <div class="showcase-timeline-container">
                <canvas id="showcase-canvas" width="800" height="400"></canvas>
            </div>

            <div class="transport-controls">
                <button id="showcase-play-pause-btn" class="control-button">⏸️</button>
                <button id="showcase-restart-btn" class="control-button">⏮️</button>
                <div class="progress-container">
                    <input type="range" id="showcase-progress-bar" min="0" max="24" step="0.1" value="0">
                    <span id="showcase-time-display">0.0 / 24.0</span>
                </div>
            </div>

            <div class="showcase-buttons">
                <button id="prev-song-btn" class="secondary-button">← Previous Song</button>
                <button id="next-song-btn" class="secondary-button">Next Song →</button>
                <button id="showcase-restart-game-btn" class="secondary-button">Play Again</button>
                <button id="showcase-exit-btn" class="primary-button">Exit</button>
            </div>
        </div>
    </div>

    <script type="module" src="js/MultiplayerGame.js"></script>
</body>
</html>
